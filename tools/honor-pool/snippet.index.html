<!-- {"title": "Honor Pool Estimation", "rel": "../../", "header": false} -->
<script>
// LIB
function get(id) {
  return document.getElementById(id)
}
function setText(id, text) {
  get(id).textContent = text
}
// END LIB
</script>

<noscript><div class="card error fluid">Please activate Javascript to use this site!</div></noscript>

<h1><a href="https://www.vanillawar.com">&lt;</a> WoW Classic Honor Pool Estimation</h1>

<form id="input" action="https://vanillawar-honor-pool.herokuapp.com/data" method="post">
    <label for="before" style="vertical-align: top;">HonorSpy<br><small>(before update)</small></label>
    <textarea id="before" name="before" style="font-family:monospace;width:100%;"></textarea><br>
    <label for="after" style="vertical-align: top;">HonorSpy<br><small>(after update)</small></label>
    <textarea id="after" name="after" style="font-family:monospace;width:100%;"></textarea><br>
    <input type="submit" value="Calculate">
    <input type="button" value="Clear" onclick="location.href='https://www.vanillawar.com/tools/honor-pool/'">
    <input type="button" value="Example" onclick="location.href='https://www.vanillawar.com/tools/honor-pool/'">
</form>

<h2>Results</h2>

<textarea id="results" style="width:100%;font-family:monospace;" readonly>
</textarea>

<script>
</script>

<h3>Info</h3>

<p>
    WIP
</p>

<script src="https://vanillawar-honor-pool.herokuapp.com/warmup.js"></script>
<iframe id="data_loader" src="" style="display:none;"></iframe>

<script type="text/javascript">
function getParameters() {
    const url = new URL(window.location.href)
    let parameters = {
        'data': String(url.searchParams.get('data') || '')
    }
    return parameters
}
var PARAMS = getParameters()
if (PARAMS['data'] !== '') {
  var id = PARAMS['data']
  //setText('results', PARAMS['data'])
  fetch(`https://vanillawar-honor-pool.herokuapp.com/data/${id}.txt`)
  .then(
    function(response) {
      if (response.status !== 200) {
        console.log('Looks like there was a problem. Status Code: ' +
          response.status);
        return;
      }
      response.text().then(function(data) {
        setText('results', data)
        get('results').style.height = get('results').scrollHeight + 5 + "px"
      });
    }
  )
  .catch(function(err) {
    console.log('fetch error: ', err);
  });
}
</script>
